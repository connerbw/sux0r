suxValidate extends SmartyValidate.

suxValidate protects against form spoofing and makes sure that a form submission is
intentional by adding a hidden form field with a one-time token, storing this
token in the user's SmartyValidate session.

EXAMPLE:

    index.php
    ---------

    <?php
    session_start();

    // you will need to setup Smarty if
    // the defaults are not correct.

    require('Smarty.class.php');
    require('suxValidate.php');

    $smarty = new Smarty();

    if(!empty($_POST) && suxValidate::is_registered_form()) {

        // validate after a POST
        suxValidate::connect($smarty);

        if(suxValidate::is_valid($_POST)) {

            // no errors, done with suxValidate
            suxValidate::disconnect();
            $smarty->display('success.tpl');
            exit;

        }
        else {

            // error, redraw the form
            $smarty->assign($_POST);

        }
    }
    else {

        // new form, we (re)set the session data
        suxValidate::connect($smarty, true);

        // register our validators
        suxValidate::register_validator('fullname', 'FullName', 'notEmpty', false, false, 'trim');
        suxValidate::register_validator('phone', 'Phone', 'isNumber', true, false, 'trim');
        suxValidate::register_validator('expdate', 'CCExpDate', 'isCCExpDate', false, false, 'trim');
        suxValidate::register_validator('email', 'Email', 'isEmail', false, false, 'trim');
        suxValidate::register_validator('date', 'Date', 'isDate', true, false, 'trim');
        suxValidate::register_validator('password', 'password:password2', 'isEqual');

    }

    // display form
    $smarty->display('form.tpl');


    ?>

    form.tpl
    --------

    <form method="post" action="index.php">

    {*
    Protect against form spoofing, make sure that a form submission is valid and intentional
    {$token} is autogenerated and and managed by suxValidate
    *}

    <input type="hidden" name="token" value="{$token}" />

    {validate id="fullname" message="Full Name Cannot Be Empty"}
    Full Name: <input type="text" name="FullName" value="{$FullName|escape}"><br />
    {validate id="phone" message="Phone Number Must be a Number"}
    Phone :<input type="text" name="Phone" value="{$Phone|escape}" empty="yes"><br />
    {validate id="expdate" message="Exp Date not valid"}
    Exp Date: <input type="text" name="CCExpDate" size="8" value="{$CCExpDate|escape}"><br />
    {validate id="email" message="Email not valid"}
    Email: <input type="text" name="Email" size="30" value="{$Email|escape}"><br />
    {validate id="date" message="Date not valid"}
    Date: <input type="text" name="Date" size="10" value="{$Date|escape}"><br />
    {validate id="password" message="passwords do not match"}
    password: <input type="password" name="password" size="10" value="{$password|escape}"><br />
    password2: <input type="password" name="password2" size="10" value="{$password2|escape}"><br />

    <input type="submit">
    </form>

    success.tpl
    -----------

    <p>Your form submission succeeded.</p>